# 安泰创新 CDViewer 影像文件排序

## 前言

从某医院拿回来的CT检查报告的数字版，打开CDViewer发现里面的片子都是乱的，于是写个小脚本把它们重新排个序

## 使用

1. 创建 input、output 文件夹
2. 将医院发回来的整个数字版影像放到 input 文件夹下（建议做好备份）
3. 执行
    ```bash
    python app.py
    ```
4. 将 output 下对应的 IMAGE 文件夹覆盖回 input 对应的 IMAGE 文件夹
5. 打开 CDViewer，点开一个系列的影像来回翻页，可以看到这时影像的顺序应该是正确的了

> 脚本在 WIN10, python3.9.5 下测试通过。


## 影像文件分析

拿到 CT 检查报告的数字版，发现里面 IMAGE 文件夹就是存放 CT 图像的。图像文件不是图片，而是一种 `dcm` 做文件后缀的私有格式。

这种dcm文件（在我这里）有两个版本，一种是 1.2.156 ，另一种是 1.2.840，如果你也有一样的检查报告，看目录就知道了。

- 1.2.156

    0xfc 处开始就是图片的顺序号

- 1.2.840

    顺序号 0x8d0 到 0x8e0 之间



## 最后，愿天下无疾